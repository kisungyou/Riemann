<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Riemannian Manifold Metric Learning — riem.rmml • Riemann</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Riemannian Manifold Metric Learning — riem.rmml"><meta name="description" content="Given \(N\) observations \(X_1, X_2, \ldots, X_N \in \mathcal{M}\) and
corresponding label information, riem.rmml computes pairwise distance of data under Riemannian Manifold Metric Learning
(RMML) framework based on equivariant embedding. When the number of data points
is not sufficient, an inverse of scatter matrix does not exist analytically so
the small regularization parameter \(\lambda\) is recommended with default value of \(\lambda=0.1\)."><meta property="og:description" content="Given \(N\) observations \(X_1, X_2, \ldots, X_N \in \mathcal{M}\) and
corresponding label information, riem.rmml computes pairwise distance of data under Riemannian Manifold Metric Learning
(RMML) framework based on equivariant embedding. When the number of data points
is not sufficient, an inverse of scatter matrix does not exist analytically so
the small regularization parameter \(\lambda\) is recommended with default value of \(\lambda=0.1\)."><meta property="og:image" content="https://kisungyou.com/Riemann/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Riemann</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://CRAN.R-project.org/package=RiemBase">(CRAN) RiemBase</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/Rdimtools/">Rdimtools</a></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/T4cluster/">T4cluster</a></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/T4transport/">T4transport</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/kisung_you"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kisungyou/Riemann"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:kisungyou@outlook.com"><span class="fa fa-envelope"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Riemannian Manifold Metric Learning</h1>
      <small class="dont-index">Source: <a href="https://github.com/kisungyou/Riemann/blob/HEAD/R/learning_rmml.R" class="external-link"><code>R/learning_rmml.R</code></a></small>
      <div class="d-none name"><code>riem.rmml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given \(N\) observations \(X_1, X_2, \ldots, X_N \in \mathcal{M}\) and
corresponding label information, <code>riem.rmml</code> computes pairwise distance of data under Riemannian Manifold Metric Learning
(RMML) framework based on equivariant embedding. When the number of data points
is not sufficient, an inverse of scatter matrix does not exist analytically so
the small regularization parameter \(\lambda\) is recommended with default value of \(\lambda=0.1\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">riem.rmml</span><span class="op">(</span><span class="va">riemobj</span>, <span class="va">label</span>, lambda <span class="op">=</span> <span class="fl">0.1</span>, as.dist <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-riemobj">riemobj<a class="anchor" aria-label="anchor" href="#arg-riemobj"></a></dt>
<dd><p>a S3 <code>"riemdata"</code> class for \(N\) manifold-valued data.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>a length-\(N\) vector of class labels. <code>NA</code> values are omitted.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>regularization parameter. If \(\lambda \leq 0\), no regularization is applied.</p></dd>


<dt id="arg-as-dist">as.dist<a class="anchor" aria-label="anchor" href="#arg-as-dist"></a></dt>
<dd><p>logical; if <code>TRUE</code>, it returns <code>dist</code> object, else it returns a symmetric matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a S3 <code>dist</code> object or \((N\times N)\) symmetric matrix of pairwise distances according to <code>as.dist</code> parameter.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Zhu P, Cheng H, Hu Q, Wang Q, Zhang C (2018).
“Towards Generalized and Efficient Metric Learning on Riemannian Manifold.”
In <em>Proceedings of the Twenty-Seventh International Joint Conference on Artificial Intelligence</em>, 3235–3241.
ISBN 978-0-9992411-2-7.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#            Distance between Two Classes of SPD Matrices</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#  Class 1 : Empirical Covariance from Standard Normal Distribution</span></span></span>
<span class="r-in"><span><span class="co">#  Class 2 : Empirical Covariance from Perturbed 'iris' dataset</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## DATA GENERATION</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ndata</span>  <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ndata</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">mydata</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="op">(</span><span class="va">ndata</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">ndata</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tmpdata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">150</span><span class="op">*</span><span class="fl">4</span>,sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mydata</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">tmpdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">myriem</span> <span class="op">=</span> <span class="fu"><a href="wrap.spd.html">wrap.spd</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mylabs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, each<span class="op">=</span><span class="va">ndata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## COMPUTE GEODESIC AND RMML PAIRWISE DISTANCE</span></span></span>
<span class="r-in"><span><span class="va">pdgeo</span> <span class="op">=</span> <span class="fu"><a href="riem.pdist.html">riem.pdist</a></span><span class="op">(</span><span class="va">myriem</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pdmdl</span> <span class="op">=</span> <span class="fu">riem.rmml</span><span class="op">(</span><span class="va">myriem</span>, label<span class="op">=</span><span class="va">mylabs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## VISUALIZE</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, pty<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">pdgeo</span><span class="op">[</span>,<span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">ndata</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"geodesic distance"</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">pdmdl</span><span class="op">[</span>,<span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">ndata</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"RMML distance"</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="riem.rmml-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://kisungyou.com" class="external-link">Kisung You</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

