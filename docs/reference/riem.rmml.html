<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Riemannian Manifold Metric Learning — riem.rmml • Riemann</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Riemannian Manifold Metric Learning — riem.rmml" />
<meta property="og:description" content="Given \(N\) observations \(X_1, X_2, \ldots, X_N \in \mathcal{M}\) and 
corresponding label information, riem.rmml computes pairwise distance of data under Riemannian Manifold Metric Learning 
(RMML) framework based on equivariant embedding. When the number of data points 
is not sufficient, an inverse of scatter matrix does not exist analytically so 
the small regularization parameter \(\lambda\) is recommended with default value of \(\lambda=0.1\)." />
<meta property="og:image" content="https://kyoustat.com/Riemann/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Riemann</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/RiemannBasic.html">Riemann 101 : A First Step</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://CRAN.R-project.org/package=RiemBase">(CRAN) RiemBase</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://kyoustat.com/Rdimtools/">Rdimtools</a>
    </li>
    <li>
      <a href="https://kyoustat.com/T4cluster/">T4cluster</a>
    </li>
    <li>
      <a href="https://kyoustat.com/T4transport/">T4transport</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/kyoustat">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/kyoustat/Riemann">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:kyoustat@gmail.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Riemannian Manifold Metric Learning</h1>
    <small class="dont-index">Source: <a href='https://github.com/kyoustat/Riemann/blob/master/R/learning_rmml.R'><code>R/learning_rmml.R</code></a></small>
    <div class="hidden name"><code>riem.rmml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given \(N\) observations \(X_1, X_2, \ldots, X_N \in \mathcal{M}\) and 
corresponding label information, <code>riem.rmml</code> computes pairwise distance of data under Riemannian Manifold Metric Learning 
(RMML) framework based on equivariant embedding. When the number of data points 
is not sufficient, an inverse of scatter matrix does not exist analytically so 
the small regularization parameter \(\lambda\) is recommended with default value of \(\lambda=0.1\).</p>
    </div>

    <pre class="usage"><span class='fu'>riem.rmml</span><span class='op'>(</span><span class='va'>riemobj</span>, <span class='va'>label</span>, lambda <span class='op'>=</span> <span class='fl'>0.1</span>, as.dist <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>riemobj</th>
      <td><p>a S3 <code>"riemdata"</code> class for \(N\) manifold-valued data.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>a length-\(N\) vector of class labels. <code>NA</code> values are omitted.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>regularization parameter. If \(\lambda \leq 0\), no regularization is applied.</p></td>
    </tr>
    <tr>
      <th>as.dist</th>
      <td><p>logical; if <code>TRUE</code>, it returns <code>dist</code> object, else it returns a symmetric matrix.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a S3 <code>dist</code> object or \((N\times N)\) symmetric matrix of pairwise distances according to <code>as.dist</code> parameter.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Zhu P, Cheng H, Hu Q, Wang Q, Zhang C (2018).
&#8220;Towards Generalized and Efficient Metric Learning on Riemannian Manifold.&#8221;
In <em>Proceedings of the Twenty-Seventh International Joint Conference on Artificial Intelligence</em>, 3235--3241.
ISBN 978-0-9992411-2-7, doi: <a href='https://doi.org/10.24963/ijcai.2018/449'>10.24963/ijcai.2018/449</a>
.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#-------------------------------------------------------------------</span>
<span class='co'>#            Distance between Two Classes of SPD Matrices</span>
<span class='co'>#</span>
<span class='co'>#  Class 1 : Empirical Covariance from Standard Normal Distribution</span>
<span class='co'>#  Class 2 : Empirical Covariance from Perturbed 'iris' dataset</span>
<span class='co'>#-------------------------------------------------------------------</span>
<span class='co'>## DATA GENERATION</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
<span class='va'>ndata</span>  <span class='op'>=</span> <span class='fl'>10</span>
<span class='va'>mydata</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>ndata</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>mydata</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>*</span><span class='fl'>4</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>ndata</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>ndata</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>tmpdata</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>150</span><span class='op'>*</span><span class='fl'>4</span>,sd<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
  <span class='va'>mydata</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov</a></span><span class='op'>(</span><span class='va'>tmpdata</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>myriem</span> <span class='op'>=</span> <span class='fu'><a href='wrap.spd.html'>wrap.spd</a></span><span class='op'>(</span><span class='va'>mydata</span><span class='op'>)</span>
<span class='va'>mylabs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, each<span class='op'>=</span><span class='va'>ndata</span><span class='op'>)</span>

<span class='co'>## COMPUTE GEODESIC AND RMML PAIRWISE DISTANCE</span>
<span class='va'>pdgeo</span> <span class='op'>=</span> <span class='fu'><a href='riem.pdist.html'>riem.pdist</a></span><span class='op'>(</span><span class='va'>myriem</span><span class='op'>)</span>
<span class='va'>pdmdl</span> <span class='op'>=</span> <span class='fu'>riem.rmml</span><span class='op'>(</span><span class='va'>myriem</span>, label<span class='op'>=</span><span class='va'>mylabs</span><span class='op'>)</span>

<span class='co'>## VISUALIZE</span>
<span class='va'>opar</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>no.readonly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, pty<span class='op'>=</span><span class='st'>"s"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>pdgeo</span><span class='op'>[</span>,<span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>ndata</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>]</span>, main<span class='op'>=</span><span class='st'>"geodesic distance"</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>pdmdl</span><span class='op'>[</span>,<span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>ndata</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>]</span>, main<span class='op'>=</span><span class='st'>"RMML distance"</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='riem.rmml-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>opar</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kisung You.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


