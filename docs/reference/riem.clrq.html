<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Competitive Learning Riemannian Quantization — riem.clrq • Riemann</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Competitive Learning Riemannian Quantization — riem.clrq"><meta name="description" content="Given \(N\) observations  \(X_1, X_2, \ldots, X_N \in \mathcal{M}\),
perform clustering via Competitive Learning Riemannian Quantization (CLRQ).
Originally, the algorithm is designed for finding voronoi cells that are
used in domain quantization. Given the discrete measure of data, centers of the cells
play a role of cluster centers and data are labeled accordingly based on the distance
to voronoi centers. For an iterative update of centers, gradient descent algorithm
adapted for the Riemannian manifold setting is used with the gain factor sequence
$$\gamma_t = \frac{a}{1 + b \sqrt{t}}$$
where two parameters \(a,b\) are represented by par.a and par.b. For
initialization, we provide k-means++ and random seeding options as in k-means."><meta property="og:description" content="Given \(N\) observations  \(X_1, X_2, \ldots, X_N \in \mathcal{M}\),
perform clustering via Competitive Learning Riemannian Quantization (CLRQ).
Originally, the algorithm is designed for finding voronoi cells that are
used in domain quantization. Given the discrete measure of data, centers of the cells
play a role of cluster centers and data are labeled accordingly based on the distance
to voronoi centers. For an iterative update of centers, gradient descent algorithm
adapted for the Riemannian manifold setting is used with the gain factor sequence
$$\gamma_t = \frac{a}{1 + b \sqrt{t}}$$
where two parameters \(a,b\) are represented by par.a and par.b. For
initialization, we provide k-means++ and random seeding options as in k-means."><meta property="og:image" content="https://kisungyou.com/Riemann/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Riemann</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://CRAN.R-project.org/package=RiemBase">(CRAN) RiemBase</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/Rdimtools/">Rdimtools</a></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/T4cluster/">T4cluster</a></li>
    <li><a class="external-link dropdown-item" href="https://kisungyou.com/T4transport/">T4transport</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/kisung_you"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kisungyou/Riemann"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:kisungyou@outlook.com"><span class="fa fa-envelope"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Competitive Learning Riemannian Quantization</h1>
      <small class="dont-index">Source: <a href="https://github.com/kisungyou/Riemann/blob/HEAD/R/clustering_clrq.R" class="external-link"><code>R/clustering_clrq.R</code></a></small>
      <div class="d-none name"><code>riem.clrq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given \(N\) observations  \(X_1, X_2, \ldots, X_N \in \mathcal{M}\),
perform clustering via Competitive Learning Riemannian Quantization (CLRQ).
Originally, the algorithm is designed for finding voronoi cells that are
used in domain quantization. Given the discrete measure of data, centers of the cells
play a role of cluster centers and data are labeled accordingly based on the distance
to voronoi centers. For an iterative update of centers, gradient descent algorithm
adapted for the Riemannian manifold setting is used with the gain factor sequence
$$\gamma_t = \frac{a}{1 + b \sqrt{t}}$$
where two parameters \(a,b\) are represented by <code>par.a</code> and <code>par.b</code>. For
initialization, we provide k-means++ and random seeding options as in k-means.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">riem.clrq</span><span class="op">(</span><span class="va">riemobj</span>, k <span class="op">=</span> <span class="fl">2</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plus"</span>, <span class="st">"random"</span><span class="op">)</span>, gain.a <span class="op">=</span> <span class="fl">1</span>, gain.b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-riemobj">riemobj<a class="anchor" aria-label="anchor" href="#arg-riemobj"></a></dt>
<dd><p>a S3 <code>"riemdata"</code> class for \(N\) manifold-valued data.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of clusters.</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>(case-insensitive) name of an initialization scheme. (default: <code>"plus"</code>.)</p></dd>


<dt id="arg-gain-a">gain.a<a class="anchor" aria-label="anchor" href="#arg-gain-a"></a></dt>
<dd><p>parameter \(a\) for gain factor sequence.</p></dd>


<dt id="arg-gain-b">gain.b<a class="anchor" aria-label="anchor" href="#arg-gain-b"></a></dt>
<dd><p>parameter \(b\) for gain factor sequence.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a named list containing</p><dl><dt>centers</dt>
<dd><p>a 3d array where each slice along 3rd dimension is a matrix representation of class centers.</p></dd>

<dt>cluster</dt>
<dd><p>a length-\(N\) vector of class labels (from \(1:k\)).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Le Brigant A, Puechmorel S (2019).
“Quantization and clustering on Riemannian manifolds with an application to air traffic analysis.”
<em>Journal of Multivariate Analysis</em>, <b>173</b>, 685–703.
ISSN 0047259X.</p>
<p>Bonnabel S (2013).
“Stochastic Gradient Descent on Riemannian Manifolds.”
<em>IEEE Transactions on Automatic Control</em>, <b>58</b>(9), 2217–2229.
ISSN 0018-9286, 1558-2523.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="riem.kmeans.html">riem.kmeans</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#          Example on Sphere : a dataset with three types</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># class 1 : 10 perturbed data points near (1,0,0) on S^2 in R^3</span></span></span>
<span class="r-in"><span><span class="co"># class 2 : 10 perturbed data points near (0,1,0) on S^2 in R^3</span></span></span>
<span class="r-in"><span><span class="co"># class 3 : 10 perturbed data points near (0,0,1) on S^2 in R^3</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## GENERATE DATA</span></span></span>
<span class="r-in"><span><span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tgt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span>, sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mydata</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">tgt</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tgt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tgt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mydata</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">tgt</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tgt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tgt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2</span>, sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mydata</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">tgt</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tgt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">myriem</span> <span class="op">=</span> <span class="fu"><a href="wrap.sphere.html">wrap.sphere</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mylabs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## CLRQ WITH K=2,3,4</span></span></span>
<span class="r-in"><span><span class="va">clust2</span> <span class="op">=</span> <span class="fu">riem.clrq</span><span class="op">(</span><span class="va">myriem</span>, k<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust3</span> <span class="op">=</span> <span class="fu">riem.clrq</span><span class="op">(</span><span class="va">myriem</span>, k<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust4</span> <span class="op">=</span> <span class="fu">riem.clrq</span><span class="op">(</span><span class="va">myriem</span>, k<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## MDS FOR VISUALIZATION</span></span></span>
<span class="r-in"><span><span class="va">mds2d</span> <span class="op">=</span> <span class="fu"><a href="riem.mds.html">riem.mds</a></span><span class="op">(</span><span class="va">myriem</span>, ndim<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">embed</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## VISUALIZE</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, pty<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds2d</span>, pch<span class="op">=</span><span class="fl">19</span>, main<span class="op">=</span><span class="st">"true label"</span>, col<span class="op">=</span><span class="va">mylabs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds2d</span>, pch<span class="op">=</span><span class="fl">19</span>, main<span class="op">=</span><span class="st">"K=2"</span>, col<span class="op">=</span><span class="va">clust2</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds2d</span>, pch<span class="op">=</span><span class="fl">19</span>, main<span class="op">=</span><span class="st">"K=3"</span>, col<span class="op">=</span><span class="va">clust3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds2d</span>, pch<span class="op">=</span><span class="fl">19</span>, main<span class="op">=</span><span class="st">"K=4"</span>, col<span class="op">=</span><span class="va">clust4</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="riem.clrq-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://kisungyou.com" class="external-link">Kisung You</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

